(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){"use strict";var token="%[a-f0-9]{2}";var singleMatcher=new RegExp(token,"gi");var multiMatcher=new RegExp("("+token+")+","gi");function decodeComponents(components,split){try{return decodeURIComponent(components.join(""))}catch(err){}if(components.length===1){return components}split=split||1;var left=components.slice(0,split);var right=components.slice(split);return Array.prototype.concat.call([],decodeComponents(left),decodeComponents(right))}function decode(input){try{return decodeURIComponent(input)}catch(err){var tokens=input.match(singleMatcher);for(var i=1;i<tokens.length;i++){input=decodeComponents(tokens,i).join("");tokens=input.match(singleMatcher)}return input}}function customDecodeURIComponent(input){var replaceMap={"%FE%FF":"��","%FF%FE":"��"};var match=multiMatcher.exec(input);while(match){try{replaceMap[match[0]]=decodeURIComponent(match[0])}catch(err){var result=decode(match[0]);if(result!==match[0]){replaceMap[match[0]]=result}}match=multiMatcher.exec(input)}replaceMap["%C2"]="�";var entries=Object.keys(replaceMap);for(var i=0;i<entries.length;i++){var key=entries[i];input=input.replace(new RegExp(key,"g"),replaceMap[key])}return input}module.exports=function(encodedURI){if(typeof encodedURI!=="string"){throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof encodedURI+"`")}try{encodedURI=encodedURI.replace(/\+/g," ");return decodeURIComponent(encodedURI)}catch(err){return customDecodeURIComponent(encodedURI)}}},{}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _pagination=require("./pagination");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var API=function(){function API(apiURL){_classCallCheck(this,API);this.apiURL=apiURL}_createClass(API,[{key:"headers",value:function headers(){var _headers=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return _extends({"Content-Type":"application/json"},_headers)}},{key:"parseJsonResponse",value:function parseJsonResponse(response){return response.json().then(function(json){if(!response.ok){return Promise.reject(json)}var pagination=(0,_pagination.getPagination)(response);return pagination?{pagination:pagination,items:json}:json})}},{key:"request",value:function request(path){var _this=this;var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var headers=this.headers(options.headers||{});return fetch(this.apiURL+path,_extends({},options,{headers:headers})).then(function(response){var contentType=response.headers.get("Content-Type");if(contentType&&contentType.match(/json/)){return _this.parseJsonResponse(response)}return response.text().then(function(data){if(!response.ok){return Promise.reject({data:data})}return{data:data}})})}}]);return API}();exports.default=API},{"./pagination":3}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();exports.getPagination=getPagination;function getPagination(response){var links=response.headers.get("Link");var pagination={};if(links==null){return null}links=links.split(",");var total=response.headers.get("X-Total-Count");for(var i=0,len=links.length;i<len;i++){var link=links[i].replace(/(^\s*|\s*$)/,"");var _link$split=link.split(";");var _link$split2=_slicedToArray(_link$split,2);var url=_link$split2[0];var rel=_link$split2[1];var m=url.match(/page=(\d+)/);var page=m&&parseInt(m[1],10);if(rel.match(/last/)){pagination.last=page}else if(rel.match(/next/)){pagination.next=page}else if(rel.match(/prev/)){pagination.prev=page}else if(rel.match(/first/)){pagination.first=page}}pagination.last=Math.max(pagination.last||0,pagination.prev&&pagination.prev+1||0);pagination.current=pagination.next?pagination.next-1:pagination.last||1;pagination.total=total?parseInt(total,10):null;return pagination}},{}],4:[function(require,module,exports){"use strict";var getOwnPropertySymbols=Object.getOwnPropertySymbols;var hasOwnProperty=Object.prototype.hasOwnProperty;var propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(val){if(val===null||val===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(val)}function shouldUseNative(){try{if(!Object.assign){return false}var test1=new String("abc");test1[5]="de";if(Object.getOwnPropertyNames(test1)[0]==="5"){return false}var test2={};for(var i=0;i<10;i++){test2["_"+String.fromCharCode(i)]=i}var order2=Object.getOwnPropertyNames(test2).map(function(n){return test2[n]});if(order2.join("")!=="0123456789"){return false}var test3={};"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter});if(Object.keys(Object.assign({},test3)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(err){return false}}module.exports=shouldUseNative()?Object.assign:function(target,source){var from;var to=toObject(target);var symbols;for(var s=1;s<arguments.length;s++){from=Object(arguments[s]);for(var key in from){if(hasOwnProperty.call(from,key)){to[key]=from[key]}}if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++){if(propIsEnumerable.call(from,symbols[i])){to[symbols[i]]=from[symbols[i]]}}}}return to}},{}],5:[function(require,module,exports){"use strict";var strictUriEncode=require("strict-uri-encode");var objectAssign=require("object-assign");var decodeComponent=require("decode-uri-component");function encoderForArrayFormat(opts){switch(opts.arrayFormat){case"index":return function(key,value,index){return value===null?[encode(key,opts),"[",index,"]"].join(""):[encode(key,opts),"[",encode(index,opts),"]=",encode(value,opts)].join("")};case"bracket":return function(key,value){return value===null?encode(key,opts):[encode(key,opts),"[]=",encode(value,opts)].join("")};default:return function(key,value){return value===null?encode(key,opts):[encode(key,opts),"=",encode(value,opts)].join("")}}}function parserForArrayFormat(opts){var result;switch(opts.arrayFormat){case"index":return function(key,value,accumulator){result=/\[(\d*)\]$/.exec(key);key=key.replace(/\[\d*\]$/,"");if(!result){accumulator[key]=value;return}if(accumulator[key]===undefined){accumulator[key]={}}accumulator[key][result[1]]=value};case"bracket":return function(key,value,accumulator){result=/(\[\])$/.exec(key);key=key.replace(/\[\]$/,"");if(!result){accumulator[key]=value;return}else if(accumulator[key]===undefined){accumulator[key]=[value];return}accumulator[key]=[].concat(accumulator[key],value)};default:return function(key,value,accumulator){if(accumulator[key]===undefined){accumulator[key]=value;return}accumulator[key]=[].concat(accumulator[key],value)}}}function encode(value,opts){if(opts.encode){return opts.strict?strictUriEncode(value):encodeURIComponent(value)}return value}function keysSorter(input){if(Array.isArray(input)){return input.sort()}else if(typeof input==="object"){return keysSorter(Object.keys(input)).sort(function(a,b){return Number(a)-Number(b)}).map(function(key){return input[key]})}return input}exports.extract=function(str){return str.split("?")[1]||""};exports.parse=function(str,opts){opts=objectAssign({arrayFormat:"none"},opts);var formatter=parserForArrayFormat(opts);var ret=Object.create(null);if(typeof str!=="string"){return ret}str=str.trim().replace(/^(\?|#|&)/,"");if(!str){return ret}str.split("&").forEach(function(param){var parts=param.replace(/\+/g," ").split("=");var key=parts.shift();var val=parts.length>0?parts.join("="):undefined;val=val===undefined?null:decodeComponent(val);formatter(decodeComponent(key),val,ret)});return Object.keys(ret).sort().reduce(function(result,key){var val=ret[key];if(Boolean(val)&&typeof val==="object"&&!Array.isArray(val)){result[key]=keysSorter(val)}else{result[key]=val}return result},Object.create(null))};exports.stringify=function(obj,opts){var defaults={encode:true,strict:true,arrayFormat:"none"};opts=objectAssign(defaults,opts);var formatter=encoderForArrayFormat(opts);return obj?Object.keys(obj).sort().map(function(key){var val=obj[key];if(val===undefined){return""}if(val===null){return encode(key,opts)}if(Array.isArray(val)){var result=[];val.slice().forEach(function(val2){if(val2===undefined){return}result.push(formatter(key,val2,result.length))});return result.join("&")}return encode(key,opts)+"="+encode(val,opts)}).filter(function(x){return x.length>0}).join("&"):""}},{"decode-uri-component":1,"object-assign":4,"strict-uri-encode":6}],6:[function(require,module,exports){"use strict";module.exports=function(str){return encodeURIComponent(str).replace(/[!'()*]/g,function(c){return"%"+c.charCodeAt(0).toString(16).toUpperCase()})}},{}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _queryString=require("query-string");var _queryString2=_interopRequireDefault(_queryString);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Admin=function(){function Admin(user){_classCallCheck(this,Admin);this.user=user}_createClass(Admin,[{key:"listUsers",value:function listUsers(aud){return this.user.request("/admin/users",{method:"GET",audience:aud})}},{key:"getUser",value:function getUser(user){return this.user.request("/admin/user?"+_queryString2.default.stringify(user))}},{key:"updateUser",value:function updateUser(user){var attributes=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};attributes.user=user;return this.user.request("/admin/user",{method:"PUT",body:JSON.stringify(attributes)})}},{key:"createUser",value:function createUser(email,password){var attributes=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};attributes.email=email;attributes.password=password;return this.user.request("/admin/user",{method:"POST",body:JSON.stringify(attributes)})}},{key:"deleteUser",value:function deleteUser(user){return this.user.request("/admin/user",{method:"DELETE",body:JSON.stringify(user)})}}]);return Admin}();exports.default=Admin},{"query-string":5}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _microApiClient=require("micro-api-client");var _microApiClient2=_interopRequireDefault(_microApiClient);var _user=require("./user");var _user2=_interopRequireDefault(_user);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var HTTPRegexp=/^http:\/\//;var defaultApiURL="https://"+window.location.hostname+"/.netlify/identity";var GoTrue=function(){function GoTrue(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$APIUrl=_ref.APIUrl,APIUrl=_ref$APIUrl===undefined?defaultApiURL:_ref$APIUrl,_ref$Audience=_ref.Audience,Audience=_ref$Audience===undefined?"":_ref$Audience;_classCallCheck(this,GoTrue);if(APIUrl.match(HTTPRegexp)){console.warn("Warning:\n\nDO NOT USE HTTP IN PRODUCTION FOR GOTRUE EVER!\nGoTrue REQUIRES HTTPS to work securely.")}if(Audience){this.audience=Audience}this.api=new _microApiClient2.default(APIUrl)}_createClass(GoTrue,[{key:"request",value:function request(path){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};options.headers=options.headers||{};var aud=options.audience||this.audience;if(aud){options.headers["X-JWT-AUD"]=aud}return this.api.request(path,options)}},{key:"signup",value:function signup(email,password,data){return this.request("/signup",{method:"POST",body:JSON.stringify({email:email,password:password,data:data})})}},{key:"signupExternal",value:function signupExternal(provider){return this.request("/authorize?provider="+provider)}},{key:"login",value:function login(email,password,remember){var _this=this;return this.request("/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"grant_type=password&username="+encodeURIComponent(email)+"&password="+encodeURIComponent(password)}).then(function(response){var user=new _user2.default(_this.api,response,_this.audience);user.persistSession(null);return user.reload()}).then(function(user){if(remember){user.persistSession(user)}return user})}},{key:"loginExternal",value:function loginExternal(provider){return this.request("/authorize?provider="+provider)}},{key:"confirm",value:function confirm(token){return this.verify("signup",token)}},{key:"requestPasswordRecovery",value:function requestPasswordRecovery(email){return this.request("/recover",{method:"POST",body:JSON.stringify({email:email})})}},{key:"recover",value:function recover(token){return this.verify("recovery",token)}},{key:"user",value:function user(tokenResponse){return new _user2.default(this.api,tokenResponse)}},{key:"currentUser",value:function currentUser(){return _user2.default.recoverSession()}},{key:"verify",value:function verify(type,token){var _this2=this;return this.request("/verify",{method:"POST",body:JSON.stringify({token:token,type:type})}).then(function(response){return new _user2.default(_this2.api,response).reload()})}}]);return GoTrue}();exports.default=GoTrue;if(typeof window!=="undefined"){window.GoTrue=GoTrue}},{"./user":9,"micro-api-client":2}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _microApiClient=require("micro-api-client");var _microApiClient2=_interopRequireDefault(_microApiClient);var _admin=require("./admin");var _admin2=_interopRequireDefault(_admin);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ExpiryMargin=60*1e3;var storageKey="gotrue.user";var currentUser=null;var User=function(){function User(api,tokenResponse,audience){_classCallCheck(this,User);this.api=api;this.processTokenResponse(tokenResponse);this.audience=audience;this.admin=new _admin2.default(this)}_createClass(User,[{key:"update",value:function update(attributes){var _this=this;return this.request("/user",{method:"PUT",body:JSON.stringify(attributes)}).then(function(response){for(var key in response){_this[key]=response[key]}return _this})}},{key:"jwt",value:function jwt(){var _this2=this;var _tokenDetails=this.tokenDetails(),jwt_expiry=_tokenDetails.jwt_expiry,refreshToken=_tokenDetails.refreshToken,jwt_token=_tokenDetails.jwt_token;if(jwt_expiry-ExpiryMargin<(new Date).getTime()){return this.api.request("/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"grant_type=refresh_token&refresh_token="+refreshToken}).then(function(response){_this2.processTokenResponse(response);_this2.refreshPersistedSession(_this2);return _this2.jwt_token}).catch(function(error){console.error("failed to refresh token: %o",error);_this2.persistSession(null);_this2.jwt_expiry=_this2.refreshToken=_this2.jwt_token=null;return Promise.reject(error)})}return Promise.resolve(jwt_token)}},{key:"logout",value:function logout(){return this.request("/logout",{method:"POST"}).then(this.clearSession.bind(this)).catch(this.clearSession.bind(this))}},{key:"request",value:function request(path,options){var _this3=this;options=options||{};options.headers=options.headers||{};var aud=options.audience||this.audience;if(aud){options.headers["X-JWT-AUD"]=aud}return this.jwt().then(function(token){return _this3.api.request(path,_extends({headers:Object.assign(options.headers,{Authorization:"Bearer "+token})},options))})}},{key:"reload",value:function reload(){return this.request("/user").then(this.process.bind(this)).then(this.refreshPersistedSession.bind(this))}},{key:"process",value:function process(attributes){for(var key in attributes){if(key in User.prototype||key=="api"){continue}this[key]=attributes[key]}return this}},{key:"processTokenResponse",value:function processTokenResponse(tokenResponse){this.tokenResponse=tokenResponse;this.refreshToken=tokenResponse.refresh_token;this.jwt_token=tokenResponse.access_token;this.jwt_expiry=Date.now()+tokenResponse.expires_in*1e3}},{key:"refreshPersistedSession",value:function refreshPersistedSession(user){currentUser=user;if(localStorage.getItem(storageKey)){this.persistSession(user)}return user}},{key:"persistSession",value:function persistSession(user){currentUser=user;if(user){localStorage.setItem(storageKey,JSON.stringify(user))}else{localStorage.removeItem(storageKey)}return user}},{key:"tokenDetails",value:function tokenDetails(){var fromStorage=localStorage.getItem(storageKey);if(fromStorage){return JSON.parse(fromStorage)}return{expires_in:this.expires_in,refreshToken:this.refreshToken,jwt_token:this.jwt_token}}},{key:"clearSession",value:function clearSession(){localStorage.removeItem(storageKey)}}],[{key:"recoverSession",value:function recoverSession(){if(currentUser){return currentUser}var json=localStorage.getItem(storageKey);if(json){var data=JSON.parse(json);var api=new _microApiClient2.default(data.api.apiURL);return new User(api,data.tokenResponse).process(data)}return null}}]);return User}();exports.default=User},{"./admin":7,"micro-api-client":2}]},{},[8]);
